<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover">
    <title>è¯¥åšå•¥ Â· é©¬å¹´äººç”Ÿè¿›åº¦æ»šé›ªçƒ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: system-ui, -apple-system, 'PingFang SC', 'Microsoft YaHei', sans-serif;
        }
        body {
            background-color: #fae6e0;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 20px;
            min-width: 320px;
        }
        #app {
            max-width: 600px;
            width: 100%;
            background-color: #fff8f5;
            border-radius: 32px;
            box-shadow: 0 12px 30px rgba(199,69,43,0.15);
            padding: 28px 24px;
            position: relative;
            border: 1px solid #ffd9cf;
        }

        /* ç½®é¡¶å…‹éš†è¿›åº¦æ¡å®¹å™¨ */
        #sticky-progress-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1000;
            display: none;
            background-color: #fff8f5;
            box-shadow: 0 4px 12px rgba(199,69,43,0.2);
            padding: 10px 0;
            border-bottom: 2px solid #C7452B;
        }
        #sticky-progress-container .sticky-content {
            max-width: 600px;
            margin: 0 auto;
            padding: 0 24px;
        }

        /* çƒŸèŠ±å½©è›‹ */
        .firework {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
            display: none;
        }
        .firework.show {
            display: block;
            animation: firework 1.5s ease-out;
        }
        @keyframes firework {
            0% { background: radial-gradient(circle, rgba(255,215,0,0) 0%, rgba(255,215,0,0) 100%); }
            30% { background: radial-gradient(circle, rgba(255,215,0,0.8) 0%, rgba(199,69,43,0) 70%); }
            100% { background: radial-gradient(circle, rgba(255,215,0,0) 0%, rgba(199,69,43,0) 100%); }
        }

        /* åˆ é™¤ç¡®è®¤å¼¹çª— */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }
        .modal.show {
            display: flex;
        }
        .modal-content {
            background: white;
            padding: 28px;
            border-radius: 28px;
            max-width: 360px;
            text-align: center;
        }
        .modal-buttons {
            display: flex;
            gap: 16px;
            margin-top: 24px;
            justify-content: center;
        }
        .modal-btn {
            padding: 14px 28px;
            border-radius: 40px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            font-size: 16px;
        }
        .modal-btn.confirm {
            background: #C7452B;
            color: white;
        }
        .modal-btn.cancel {
            background: #e0e0e0;
        }

        /* å›¾ç‰‡æµ®å±‚æ ·å¼ */
        .image-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            z-index: 20000;
            display: flex;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(4px);
        }
        .image-modal-container {
            background: #fff8f5;
            border-radius: 32px;
            max-width: 90%;
            max-height: 90%;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0,0,0,0.5);
            border: 2px solid #FFD700;
        }
        .image-modal-body {
            padding: 20px 20px 10px 20px;
            text-align: center;
        }
        .image-modal-body img {
            max-width: 100%;
            max-height: 60vh;
            border-radius: 24px;
            border: 2px solid #C7452B;
            box-shadow: 0 8px 16px rgba(199,69,43,0.3);
        }
        .image-modal-footer {
            padding: 10px 20px 20px 20px;
            text-align: center;
        }
        .save-tip {
            background: linear-gradient(145deg, #C7452B, #E86B4F);
            color: white;
            padding: 12px 20px;
            border-radius: 60px;
            font-size: 18px;
            font-weight: 600;
            border: 1px solid #FFD700;
            box-shadow: 0 4px 12px rgba(199,69,43,0.4);
            margin-bottom: 16px;
        }
        .close-modal-btn {
            background: #fff0e8;
            border: 2px solid #C7452B;
            color: #C7452B;
            padding: 12px 30px;
            border-radius: 40px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-block;
        }
        .close-modal-btn:hover {
            background: #C7452B;
            color: white;
        }

        /* å…¨å±€å·¥å…·æ  */
        .global-toolbar {
            display: flex;
            gap: 12px;
            margin-bottom: 24px;
            justify-content: space-between;
        }
        .global-btn {
            background: #fff0e8;
            border: 1px solid #C7452B;
            color: #C7452B;
            padding: 12px 12px;
            border-radius: 30px;
            font-size: 14px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            flex: 1;
            justify-content: center;
            transition: all 0.2s;
            white-space: nowrap;
        }
        .global-btn:hover {
            background: #C7452B;
            color: white;
        }
        .global-btn.reset:hover {
            background: #8B4B3E;
            border-color: #8B4B3E;
        }

        /* é©¬å¹´æ–°æ˜¥æ¨ªå¹… */
        .new-year-banner {
            background: linear-gradient(90deg, #C7452B, #E86B4F);
            color: white;
            text-align: center;
            padding: 14px;
            border-radius: 60px;
            margin-bottom: 16px;
            font-weight: 600;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: 0 4px 12px rgba(199,69,43,0.4);
        }

        /* é¡¶éƒ¨ç¥ç¦è¯­ */
        .top-blessing {
            background: #fff0e8;
            color: #C7452B;
            text-align: center;
            padding: 14px;
            border-radius: 40px;
            margin-bottom: 20px;
            font-size: 18px;
            font-weight: 600;
            border: 2px solid #FFD700;
            box-shadow: 0 4px 8px rgba(199,69,43,0.1);
        }
        .top-blessing span {
            font-size: 24px;
            margin: 0 6px;
        }

        .snow-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            background: linear-gradient(145deg, #fff0e8, #fff8f5);
            padding: 12px 0;
        }
        .snow-header h2 {
            font-size: 28px;
            font-weight: 700;
            color: #C7452B;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .snow-badge {
            background-color: #C7452B;
            color: white;
            padding: 10px 20px;
            border-radius: 50px;
            font-size: 18px;
            font-weight: 600;
            box-shadow: 0 4px 8px rgba(199,69,43,0.3);
        }

        /* è¿›åº¦æ¡æ¨¡å— */
        #progress-module {
            background: linear-gradient(145deg, #fff0e8, #fff8f5);
            border-radius: 24px;
            padding: 20px 24px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(199,69,43,0.1);
            border: 1px solid #ffe1d6;
        }
        .progress-title {
            display: flex;
            justify-content: space-between;
            color: #C7452B;
            font-weight: 600;
            margin-bottom: 12px;
            font-size: 16px;
        }
        .progress-title .stats-number {
            white-space: nowrap;
            letter-spacing: normal;
            word-spacing: normal;
        }
        .progress-bar-bg {
            background-color: #ffe1d6;
            height: 14px;
            border-radius: 20px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        .progress-fill {
            width: 0%;
            height: 14px;
            background-color: #C7452B;
            border-radius: 20px;
            transition: width 0.3s ease;
        }
        .progress-stats {
            display: flex;
            justify-content: space-between;
            font-size: 16px;
            color: #8B4B3E;
        }
        .stats-number {
            font-weight: 700;
            color: #C7452B;
        }

        /* æ¸©é¦¨æç¤ºåŒºåŸŸ */
        .wisdom-tip {
            background: #fff0e8;
            border-radius: 40px;
            padding: 14px 18px;
            margin-top: 16px;
            font-size: 15px;
            color: #8B4B3E;
            border-left: 6px solid #C7452B;
            line-height: 1.5;
            box-shadow: 0 2px 8px rgba(199,69,43,0.1);
            transition: opacity 0.3s;
        }
        .wisdom-tip i {
            color: #C7452B;
            font-style: normal;
            font-weight: 600;
        }

        /* å¹¿å‘Šæ¡ */
        .ad-banner {
            background: #fff0e8;
            color: #8B4B3E;
            text-align: center;
            padding: 12px;
            border-radius: 40px;
            margin-top: 16px;
            font-size: 15px;
            font-weight: 500;
            border: 1px dashed #C7452B;
            box-shadow: none;
        }

        /* ç­‰çº§é¢„è§ˆå·²åˆ é™¤ */

        .chapter-list {
            display: flex;
            flex-direction: column;
            gap: 24px;
            margin-bottom: 30px;
        }

        .chapter-card {
            background: #fff8f5;
            border-radius: 24px;
            padding: 18px;
            border: 1px solid #ffd9cf;
            box-shadow: 0 2px 8px rgba(199,69,43,0.05);
        }

        .chapter-header {
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            user-select: none;
        }
        .chapter-header-left {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
        }
        .chapter-icon {
            font-size: 28px;
        }
        .chapter-title {
            font-size: 18px;
            font-weight: 700;
            color: #8B4B3E;
            flex: 1;
            cursor: text;
            word-break: break-word;
        }
        .chapter-title-edit {
            flex: 1;
            padding: 8px 14px;
            border: 2px solid #C7452B;
            border-radius: 30px;
            font-size: 18px;
            font-weight: 700;
            outline: none;
            background: white;
            display: none;
        }
        .chapter-card.editing-title .chapter-title {
            display: none;
        }
        .chapter-card.editing-title .chapter-title-edit {
            display: block;
        }
        .chapter-progress {
            font-size: 16px;
            color: #C7452B;
            font-weight: 600;
            background: #ffe1d6;
            padding: 5px 14px;
            border-radius: 30px;
            margin-right: 8px;
            white-space: nowrap;
        }
        .chapter-toggle {
            font-size: 24px;
            color: #C7452B;
            width: 30px;
            text-align: center;
            transition: transform 0.2s;
        }
        .chapter-toggle.expanded {
            transform: rotate(0deg);
        }
        .chapter-toggle.collapsed {
            transform: rotate(-90deg);
        }

        .chapter-actions {
            display: flex;
            gap: 10px;
            margin: 15px 0 10px 40px;
            flex-wrap: wrap;
        }
        .chapter-actions.collapsed {
            display: none;
        }
        .chapter-btn {
            background: #fff0e8;
            border: 1px solid #C7452B;
            color: #C7452B;
            padding: 8px 16px;
            border-radius: 30px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
        }
        .chapter-btn:hover {
            background: #C7452B;
            color: white;
        }
        .chapter-btn.delete:hover {
            background: #c00;
            border-color: #c00;
            color: white;
        }

        .task-list {
            margin-top: 5px;
            padding-left: 40px;
        }
        .task-list.collapsed {
            display: none;
        }

        .task-item {
            display: flex;
            align-items: center;
            padding: 10px 0 10px 8px;
            border-bottom: 1px dashed #ffd9cf;
            font-size: 16px;
            color: #5C3D35;
            position: relative;
        }
        .task-item:hover {
            background: #fff0e8;
        }
        .task-item input[type="checkbox"] {
            margin-right: 14px;
            width: 20px;
            height: 20px;
            accent-color: #C7452B;
            border-radius: 5px;
            cursor: pointer;
            flex-shrink: 0;
        }
        .task-label {
            flex: 1;
            line-height: 1.5;
            cursor: pointer;
            word-break: break-word;
            padding-right: 8px;
        }
        .task-edit-input {
            flex: 1;
            padding: 8px 14px;
            border: 2px solid #C7452B;
            border-radius: 30px;
            font-size: 16px;
            outline: none;
            background: white;
            display: none;
        }
        .task-item.editing .task-label {
            display: none;
        }
        .task-item.editing .task-edit-input {
            display: block;
        }
        .task-delete {
            opacity: 0;
            background: none;
            border: none;
            font-size: 20px;
            color: #C7452B;
            cursor: pointer;
            padding: 8px 12px;
            transition: opacity 0.2s;
            flex-shrink: 0;
        }
        .task-item:hover .task-delete {
            opacity: 1;
        }
        .task-delete:hover {
            color: #c00;
            transform: scale(1.1);
        }

        .qrcode-footer {
            background: linear-gradient(145deg, #fff0e8, #fff8f5);
            border-radius: 24px;
            padding: 24px;
            margin: 24px 0 10px;
            text-align: center;
            border: 2px dashed #C7452B;
        }
        .qrcode-placeholder {
            width: 140px;
            height: 140px;
            background: #C7452B;
            margin: 0 auto 16px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 3px solid #FFD700;
        }
        .qrcode-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            width: 120px;
            height: 120px;
            margin: 10px auto;
        }
        .qrcode-cell {
            background-color: #FFD700;
            border-radius: 2px;
        }
        .qrcode-cell.black {
            background-color: #C7452B;
        }
        .qrcode-footer p {
            color: #C7452B;
            font-weight: 600;
            font-size: 20px;
            margin-bottom: 6px;
        }
        .qrcode-footer .sub {
            color: #E86B4F;
            font-size: 16px;
            font-weight: 500;
        }

        .blessing-message {
            background: #fff0e8;
            color: #C7452B;
            text-align: center;
            padding: 16px;
            border-radius: 40px;
            margin: 10px 0 20px 0;
            font-size: 18px;
            font-weight: 600;
            border: 1px solid #C7452B;
            box-shadow: 0 4px 12px rgba(199,69,43,0.1);
        }
        .blessing-message span {
            font-size: 24px;
            margin-right: 8px;
        }

        .action-button {
            background: linear-gradient(145deg, #C7452B, #E86B4F);
            border: none;
            border-radius: 60px;
            padding: 20px 0;
            width: 100%;
            color: white;
            font-size: 24px;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 24px 0 10px;
            box-shadow: 0 8px 16px rgba(199,69,43,0.4);
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid #FFD700;
            white-space: normal;
            word-break: break-word;
            line-height: 1.3;
        }
        .action-button:active {
            transform: scale(0.97);
            background: #C7452B;
        }

        /* åº•éƒ¨ç»Ÿè®¡ */
        .footer-note {
            text-align: center;
            color: #E86B4F;
            font-size: 15px;
            margin-top: 8px;
            font-weight: 500;
        }

        .copyright-footer {
            text-align: center;
            font-size: 12px;
            color: #c0a59c;
            margin-top: 24px;
            padding-top: 12px;
            border-top: 1px dashed #ffd9cf;
        }

        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(199,69,43,0.95);
            color: white;
            padding: 14px 28px;
            border-radius: 60px;
            font-size: 16px;
            z-index: 999;
            display: none;
            border: 1px solid #FFD700;
        }
        .toast.show {
            display: block;
        }

        /* é©¬å¹´ç»“æœåŒºåŸŸ */
        #horse-result {
            background: #fff8f5;
            border-radius: 24px;
            padding: 24px;
            margin: 20px 0;
            border: 2px solid #C7452B;
            box-shadow: 0 4px 12px rgba(199,69,43,0.2);
        }
        #rolling-area {
            text-align: center;
            margin-bottom: 20px;
            min-height: 60px;
            font-size: 24px;
            font-weight: 700;
            color: #C7452B;
        }
        #result-display {
            text-align: center;
        }
        .fortune-box {
            background: #fff0e8;
            border-radius: 40px;
            padding: 16px;
            margin: 16px 0;
            font-size: 16px;
            color: #5C3D35;
            line-height: 1.6;
        }
        .result-title {
            font-size: 20px;
            font-weight: 700;
            color: #C7452B;
            margin-bottom: 16px;
            text-align: center;
        }

        /* ========== è‡ªé€‚åº”åª’ä½“æŸ¥è¯¢ ========== */
        @media screen and (max-width: 480px) {
            body { padding: 12px; }
            #app { padding: 20px 16px; }
            #sticky-progress-container .sticky-content { padding: 0 16px; }
            .snow-header h2 { font-size: 24px; }
            .snow-badge { font-size: 16px; padding: 8px 14px; }
            .global-btn { font-size: 13px; padding: 10px 8px; white-space: normal; word-break: keep-all; }
            .chapter-title { font-size: 16px; }
            .chapter-icon { font-size: 24px; }
            .chapter-progress { font-size: 14px; padding: 4px 10px; }
            .chapter-toggle { font-size: 20px; }
            .chapter-actions { flex-wrap: wrap; gap: 8px; }
            .chapter-btn { font-size: 13px; padding: 8px 12px; white-space: normal; }
            .task-label { font-size: 14px; }
            .action-button { font-size: 20px; padding: 16px 0; }
            .top-blessing { font-size: 16px; padding: 10px; }
            .new-year-banner { font-size: 18px; padding: 10px; }
            .wisdom-tip, .ad-banner { font-size: 14px; padding: 12px; }
            .qrcode-footer p { font-size: 18px; }
            .qrcode-footer .sub { font-size: 14px; }
            .blessing-message { font-size: 16px; padding: 12px; }
            .footer-note { font-size: 13px; }
            #horse-result { padding: 18px; }
            .result-title { font-size: 18px; }
            .fortune-box { font-size: 14px; }
            .task-delete { opacity: 0.6; }
            .task-item:hover .task-delete { opacity: 1; }
        }

        @media screen and (max-width: 360px) {
            body { padding: 8px; }
            #app { padding: 16px 12px; }
            #sticky-progress-container .sticky-content { padding: 0 12px; }
            .snow-header h2 { font-size: 20px; }
            .snow-badge { font-size: 14px; padding: 6px 10px; }
            .global-btn { font-size: 12px; padding: 8px 4px; }
            .chapter-title { font-size: 14px; }
            .chapter-icon { font-size: 22px; }
            .chapter-progress { font-size: 12px; padding: 3px 8px; }
            .chapter-toggle { font-size: 18px; }
            .chapter-btn { font-size: 12px; padding: 6px 10px; }
            .task-label { font-size: 13px; }
            .action-button { font-size: 18px; padding: 14px 0; }
            .top-blessing { font-size: 14px; }
            .new-year-banner { font-size: 16px; }
            .qrcode-placeholder { width: 120px; height: 120px; }
        }

        @media screen and (min-width: 768px) {
            #app { max-width: 800px; padding: 32px 40px; }
            #sticky-progress-container .sticky-content { max-width: 800px; padding: 0 40px; }
            .snow-header h2 { font-size: 32px; }
            .global-btn { font-size: 16px; padding: 14px 16px; }
            .chapter-title { font-size: 20px; }
            .chapter-icon { font-size: 30px; }
            .task-label { font-size: 18px; }
            .action-button { font-size: 28px; padding: 22px 0; }
            .top-blessing { font-size: 20px; }
            .new-year-banner { font-size: 24px; }
            .wisdom-tip { font-size: 16px; }
            .footer-note { font-size: 16px; }
        }

        @media (hover: none) {
            .task-delete { opacity: 0.5; }
            .task-item:hover .task-delete { opacity: 0.5; }
        }

        /* åº•éƒ¨å¢åŠ å…³å¡æŒ‰é’®æ ·å¼ï¼ˆä¸åŸç¨‹åºä¸€è‡´ï¼‰ */
        .add-chapter-btn {
            background: #fff0e8;
            border: 2px dashed #C7452B;
            color: #C7452B;
            padding: 18px;
            border-radius: 50px;
            width: 100%;
            font-size: 18px;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            cursor: pointer;
            transition: all 0.2s;
            margin: 20px 0 10px;
        }
        .add-chapter-btn:hover {
            background: #C7452B;
            color: white;
        }
    </style>
    <!-- ä¸»ç”¨ CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- å¤‡ç”¨ CDNï¼ˆåŠ è½½å¤±è´¥æ—¶è‡ªåŠ¨ä½¿ç”¨ï¼‰-->
    <script>window.html2canvas || document.write('<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.0.0-rc.4/dist/html2canvas.min.js"><\/script>');</script>
</head>
<body>
    <!-- çƒŸèŠ±å½©è›‹ -->
    <div id="firework" class="firework"></div>

    <!-- åˆ é™¤ç¡®è®¤å¼¹çª— -->
    <div id="deleteModal" class="modal">
        <div class="modal-content">
            <p style="margin-bottom: 16px; font-size: 20px;">ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå…³å¡å—ï¼Ÿ</p>
            <p style="color: #C7452B; margin-bottom: 20px;">æ‰€æœ‰ä»»åŠ¡å°†æ°¸ä¹…æ¶ˆå¤±</p>
            <div class="modal-buttons">
                <button class="modal-btn cancel" id="cancelDelete">å–æ¶ˆ</button>
                <button class="modal-btn confirm" id="confirmDelete">åˆ é™¤</button>
            </div>
        </div>
    </div>

    <!-- ç½®é¡¶è¿›åº¦æ¡å®¹å™¨ -->
    <div id="sticky-progress-container">
        <div class="sticky-content">
            <div id="sticky-progress-module"></div>
        </div>
    </div>

    <div id="app">
        <!-- å…¨å±€å·¥å…·æ  -->
        <div class="global-toolbar">
            <button class="global-btn" id="exportBtn">ğŸ“¤ å¯¼å‡ºæ¸…å•</button>
            <button class="global-btn" id="importBtn">ğŸ“¥ å¯¼å…¥æ¸…å•</button>
            <button class="global-btn reset" id="resetBtn">ğŸ”„ é‡ç½®æ¸…å•</button>
        </div>

        <!-- é©¬å¹´æ–°æ˜¥æ¨ªå¹… -->
        <div class="new-year-banner">
            ğŸ´ é©¬å¹´å¤§å‰ Â· ä¸€é©¬å½“å…ˆ Â· ä¸‡äº‹èƒœæ„ ğŸ§§
        </div>

        <!-- é¡¶éƒ¨ç¥ç¦è¯­ -->
        <div class="top-blessing">
            <span>ğŸŠ</span> ç¥æˆ‘çš„å¥½æœ‹å‹é©¬å¹´å¤§å‰ï¼Œæ–°å¹´å¿«ä¹ï¼ <span>ğŸŠ</span>
        </div>

        <div class="snow-header">
            <h2><span>ğŸ´ é©¬å¹´çœ‹çœ‹ä½ æ˜¯ä»€ä¹ˆé©¬ï¼Ÿ</span></h2>
            <span class="snow-badge" id="percentBadge">0%</span>
        </div>

        <!-- è¿›åº¦æ¡æ¨¡å— -->
        <div id="progress-module">
            <div class="progress-title">
                <span>ğŸ§§ é©¬å¹´å·²è§£é”äººç”Ÿå…³å¡</span>
                <span class="stats-number" id="progressCount">0/0</span>
            </div>
            <div class="progress-bar-bg">
                <div id="progressFill" class="progress-fill" style="width: 0%;"></div>
            </div>
            <div class="progress-stats">
                <span>ğŸ é©¬å¹´è¿›åº¦</span>
                <span><span id="percentDisplay">0</span>%</span>
            </div>

            <!-- åŠ¨æ€æ¸©é¦¨æç¤ºè¯­ -->
            <div id="wisdomTip" class="wisdom-tip">
                ğŸŒ± æ…¢æ…¢æ¥ï¼Œæ¯ä¸€æ­¥éƒ½ç®—æ•°ã€‚
            </div>

            <!-- æ·¡åŒ–å¹¿å‘Šæ¡ -->
            <div class="ad-banner">
                ğŸ” å…³æ³¨ã€Œè¯¥åšå•¥ã€ç”Ÿæˆä½ çš„åŒæ¬¾äººç”Ÿè¿›åº¦
            </div>

            <!-- ç­‰çº§é¢„è§ˆå·²åˆ é™¤ -->
        </div>

        <!-- å…³å¡åˆ—è¡¨å®¹å™¨ -->
        <div id="chapterList" class="chapter-list"></div>

        <!-- åº•éƒ¨å¢åŠ å…³å¡æŒ‰é’® -->
        <button id="addChapterBtn" class="add-chapter-btn">â• å¢åŠ æ–°å…³å¡</button>

        <!-- æŸ¥çœ‹æˆ‘æ˜¯ä»€ä¹ˆé©¬æŒ‰é’® -->
        <button id="reveal-horse-btn" class="action-button" style="margin: 20px 0;">ğŸ² ç‚¹å‡»æŸ¥çœ‹æˆ‘æ˜¯ä»€ä¹ˆé©¬</button>

        <!-- é©¬å¹´ç»“æœåŒºåŸŸï¼ˆåˆå§‹éšè—ï¼‰ -->
        <div id="horse-result" style="display: none;">
            <div id="rolling-area" style="display: none;">ğŸ² å åœä¸­...</div>
            <div id="result-display">
                <div class="result-title">ğŸ´ æµ‹è¯•æˆ‘æ˜¯ä»€ä¹ˆé©¬ï¼Ÿ</div>
                <div style="text-align: center; margin-bottom: 16px;">
                    <span style="font-size: 48px;">ğŸ´</span>
                </div>
                <div style="font-size: 22px; font-weight: 700; color: #C7452B; text-align: center; margin-bottom: 8px;">
                    <span id="result-horse-name">å°é©¬é©¹</span> Â· <span id="result-horse-desc">åˆç”Ÿç‰›çŠŠä¸æ€•è™</span>
                </div>
                <div class="fortune-box">
                    <span id="result-fortune">ä»Šå¹´ä½ ä¼šé‡åˆ°ä¸€ä¸ªâ€œä¼¯ä¹â€ï¼Œä½†ä»–å¯èƒ½åªæ˜¯é—®ä½ è·¯æ€ä¹ˆèµ°â€”â€”æ²¡å…³ç³»ï¼Œä½ æŒ‡çš„è·¯ä»–è‡ªå·±èµ°é”™äº†ã€‚</span>
                </div>
                <div style="display: flex; gap: 12px; justify-content: center;">
                    <button id="retest-btn" class="global-btn" style="flex: 1; background: #fff0e8;">ğŸ”„ å†æµ‹ä¸€æ¬¡</button>
                    <button id="share-result-btn" class="global-btn" style="flex: 1; background: #fff0e8;">ğŸ“¤ åˆ†äº«ç»“æœ</button>
                </div>
            </div>
        </div>

        <!-- äºŒç»´ç åŒºåŸŸï¼ˆå¸¦ç¥ç¦è¯­ï¼‰ -->
        <div id="qrcode-footer" class="qrcode-footer">
            <div class="blessing-message">
                <span>ğŸ´</span> ç¥æˆ‘çš„å¥½æœ‹å‹é©¬å¹´å¤§å‰ï¼Œä¸‡äº‹é¡ºé‚ <span>ğŸ§§</span>
            </div>

            <div class="qrcode-placeholder">
                <div class="qrcode-grid" id="qrcode-grid"></div>
            </div>
            <p>ğŸ´ å…³æ³¨ã€Œè¯¥åšå•¥ã€Â· é©¬åˆ°æˆåŠŸ</p>
            <p class="sub">ç”Ÿæˆä½ çš„é©¬å¹´äººç”Ÿè¿›åº¦ Â· åˆ†äº«å¥½è¿</p>
        </div>

        <!-- ç”Ÿæˆé•¿å›¾æŒ‰é’® -->
        <button id="generateBtn" class="action-button">ğŸ§§ ç”Ÿæˆé©¬å¹´é•¿å›¾ Â· æœ‹å‹åœˆæ¥å¥½è¿ ğŸ´</button>

        <!-- åº•éƒ¨ç»Ÿè®¡ -->
        <div class="footer-note">
            <span id="selectedCountSmall">0</span>/<span id="totalCountSmall">0</span> é¡¹å·²å®Œæˆ Â· é©¬å¹´ä¸€é©¬å½“å…ˆ
        </div>

        <!-- ç‰ˆæƒè„šæ³¨ -->
        <div class="copyright-footer">
            Â© 2025 è¯¥åšå•¥ Â· ç‰ˆæœ¬ 1.0
        </div>
    </div>

    <!-- è½»æç¤ºæµ®å±‚ -->
    <div id="toast" class="toast"></div>

    <!-- éšè—çš„ç»“æœå ä½ï¼ˆä¾›æˆªå›¾æµ®å±‚ä½¿ç”¨ï¼‰ -->
    <div id="result" style="display: none;"></div>

    <script>
        (function() {
            // ==================== è¿åŠ¿åº“ï¼ˆ100æ¡ï¼‰ ====================
            const FORTUNES = [
                { level: 1, text: "ä»Šå¹´ä½ ä¼šé‡åˆ°ä¸€ä¸ªâ€œä¼¯ä¹â€ï¼Œä½†ä»–å¯èƒ½åªæ˜¯é—®ä½ è·¯æ€ä¹ˆèµ°â€”â€”æ²¡å…³ç³»ï¼Œä½ æŒ‡çš„è·¯ä»–è‡ªå·±èµ°é”™äº†ã€‚" },
                { level: 1, text: "è´¢è¿ä¸é”™ï¼Œå¯èƒ½ä¼šæ¡åˆ°é’±â€”â€”é¢å€¼ä¸è¶…è¿‡5å—ï¼Œä½†æ¡é’±é‚£ä¸€åˆ»çš„å¿«ä¹å€¼100å—ã€‚" },
                { level: 1, text: "æ„Ÿæƒ…è¿åŠ¿ï¼šæš—æ‹çš„äººå¯èƒ½ä¼šå¤šçœ‹ä½ ä¸€çœ¼ï¼Œå°±ä¸€çœ¼â€”â€”å¤Ÿä½ å›å‘³ä¸‰ä¸ªæœˆã€‚" },
                { level: 1, text: "äº‹ä¸šè¿åŠ¿ï¼šé¢†å¯¼ç»ˆäºè®°å¾—ä½ åå­—äº†ï¼Œè™½ç„¶å¶å°”å«é”™ï¼Œä½†å«é”™çš„é‚£ä¸ªåå­—ä¹ŸæŒºå¥½å¬ã€‚" },
                { level: 1, text: "å¥åº·è¿åŠ¿ï¼šè…¿è„šåˆ©ç´¢ï¼Œé€‚åˆå¤šè·‘å‡ æ­¥â€”â€”ä½†åˆ«è·‘å¤ªå¿«ï¼Œå®¹æ˜“æ‘”å‡ºè¡¨æƒ…åŒ…ã€‚" },
                { level: 1, text: "ä»Šå¹´æœ€å¤§çš„æ”¶è·ï¼šå­¦ä¼šäº†è‡ªå·±æ¢ç¯æ³¡ï¼Œä»æ­¤æˆä¸ºå®¶é‡Œçš„å…‰æ˜ä½¿è€…ã€‚" },
                { level: 1, text: "è´µäººè¿ï¼šä½ å¦ˆï¼Œå¥¹æ°¸è¿œè§‰å¾—ä½ é¥¿ã€‚" },
                { level: 1, text: "å°é©¬é©¹ï¼Œä»Šå¹´ä½ çš„ä»»åŠ¡å°±æ˜¯ï¼šå¤šåƒè‰ï¼Œå°‘æŒ¨è¸¢ï¼Œå¶å°”æ’’ä¸ªæ¬¢ã€‚" },
                { level: 1, text: "æ¡ƒèŠ±è¿ï¼šæœ‰ï¼Œä½†å¯èƒ½æ˜¯çƒ‚æ¡ƒèŠ±â€”â€”æ¯”å¦‚æ¥¼ä¸‹å–ç…é¥¼çš„å¤§çˆ·å¤¸ä½ å¸…ï¼Œé‚£ä¹Ÿæ˜¯æ¡ƒèŠ±ã€‚" },
                { level: 1, text: "ä»Šå¹´ä½ ä¼šè§£é”ä¸€ä¸ªæ–°æŠ€èƒ½ï¼šç†¬å¤œä¸ç§ƒå¤´ï¼Œå¹´è½»å°±æ˜¯èµ„æœ¬ã€‚" },
                { level: 1, text: "äº‹ä¸šä¸Šä¼šæœ‰å°æƒŠå–œï¼Œæ¯”å¦‚ç”²æ–¹çªç„¶è¯´â€œæ–¹æ¡ˆä¸ç”¨æ”¹äº†â€ï¼Œä½ æ¿€åŠ¨å¾—ä»¥ä¸ºåœ¨åšæ¢¦ã€‚" },
                { level: 1, text: "è´¢è¿æ–¹é¢ï¼Œå¯èƒ½ä¼šæ”¶åˆ°ä¸€ç¬”æ„å¤–ä¹‹è´¢â€”â€”æ¯”å¦‚å¾®ä¿¡çº¢åŒ…é‡Œçš„0.01å…ƒï¼Œé‚£ä¹Ÿæ˜¯çˆ±ã€‚" },
                { level: 1, text: "æ„Ÿæƒ…ä¸Šï¼Œä½ ä¼šé‡åˆ°ä¸€ä¸ªè®©ä½ å¿ƒè·³åŠ é€Ÿçš„äººâ€”â€”å› ä¸ºä»–åœ¨ä½ èº«åæ‹ä½ è‚©è†€ã€‚" },
                { level: 1, text: "å¥åº·æ–¹é¢ï¼Œä»Šå¹´ä½ ä¼šå‘ç°è‡ªå·±å±…ç„¶èƒ½è·‘5å…¬é‡Œï¼Œç„¶åæ­‡äº†ä¸‰å¤©ã€‚" },
                { level: 1, text: "ä»Šå¹´æœ€å€¼å¾—æœŸå¾…çš„äº‹ï¼šç¬¬ä¸€æ¬¡è¢«å«â€œè€å¸ˆâ€ï¼Œè™½ç„¶åªæ˜¯æ•™åŒäº‹æ€ä¹ˆç”¨å¤å°æœºã€‚" },
                { level: 1, text: "å°é©¬é©¹ï¼Œä»Šå¹´ä½ ä¼šæ˜ç™½ï¼šäººç”Ÿå°±åƒè‰åŸï¼Œè·‘ç€è·‘ç€å°±å¼€é˜”äº†ã€‚" },
                { level: 1, text: "æ¡ƒèŠ±è¿ï¼šå¯èƒ½ä¼šæœ‰äººç»™ä½ ä»‹ç»å¯¹è±¡ï¼Œä½†ä»‹ç»äººè‡ªå·±ä¹Ÿæ²¡è§è¿‡å¯¹æ–¹ã€‚" },
                { level: 1, text: "è´¢è¿ï¼šé€‚åˆå­˜é’±ï¼Œè™½ç„¶å­˜çš„ä¸å¤šï¼Œä½†çœ‹ç€æ•°å­—å¢é•¿å°±å¼€å¿ƒã€‚" },
                { level: 1, text: "ä»Šå¹´ä½ ä¼šæœ‰ä¸€ä¸ªæ–°çˆ±å¥½ï¼šç ”ç©¶æ˜Ÿåº§ï¼Œç„¶åå‘ç°è‡ªå·±çš„æ˜Ÿåº§ä»Šå¤©è¿åŠ¿ä¸é”™ã€‚" },
                { level: 1, text: "å°é©¬é©¹ï¼Œé©¬å¹´ç¥ä½ ï¼šæ‘”å€’äº†ä¹Ÿèƒ½ç¬‘ç€çˆ¬èµ·æ¥ï¼Œå› ä¸ºæ‘”è·¤çš„æ ·å­å¾ˆæç¬‘ã€‚" },

                { level: 2, text: "ä»Šå¹´ä¼šé‡åˆ°çœŸæ­£çš„ä¼¯ä¹ï¼Œä½†ä¼¯ä¹å¯èƒ½ä¹Ÿæ²¡å•¥é’±â€”â€”ä»–è´Ÿè´£å‘ç°ä½ ï¼Œä½ è´Ÿè´£ç»§ç»­ç©·ã€‚" },
                { level: 2, text: "äº‹ä¸šè¿åŠ¿ï¼šè·³æ§½çš„æœ€ä½³æ—¶æœºåœ¨ç§‹å¤©ï¼Œè‰æœ€è‚¥çš„æ—¶å€™ï¼Œè®°å¾—å¤šè¦ç‚¹è‰ã€‚" },
                { level: 2, text: "è´¢è¿ï¼šæ”¶å…¥ä¼šæ¶¨ï¼Œä½†æ¶¨ä¸è¿‡æˆ¿ç§Ÿâ€”â€”æˆ¿ç§Ÿæ¶¨å¾—æ¯”ä½ å¿«ï¼Œè¿™æ˜¯å®šå¾‹ã€‚" },
                { level: 2, text: "æ„Ÿæƒ…è¿åŠ¿ï¼šä¼šé‡åˆ°ä¸€ä¸ªâ€œæ‡‚ä½ â€çš„äººï¼Œæ‡‚ä½ ä¸ºå•¥ç©·ï¼Œæ‡‚ä½ ä¸ºå•¥åŠ ç­ã€‚" },
                { level: 2, text: "è´µäººè¿ï¼šå‰åŒäº‹ï¼Œä»–è·³æ§½åä¼šæŠŠä½ ä¹ŸæŒ–è¿‡å»ã€‚" },
                { level: 2, text: "ä»Šå¹´æœ€å¤§çš„æŒ‘æˆ˜ï¼šåœ¨å¥”è·‘å’Œèººå¹³ä¹‹é—´åå¤æ¨ªè·³ï¼Œæœ€åå‘ç°èººç€è·‘æœ€ç´¯ã€‚" },
                { level: 2, text: "æ¡ƒèŠ±è¿ï¼šæœ‰ï¼Œä½†å¯¹æ–¹å¯èƒ½ä¹Ÿæœ‰æˆ¿è´·â€”â€”ä½ ä»¬å¯ä»¥ä¸€èµ·è¿˜ï¼Œå‹åŠ›å‡åŠã€‚" },
                { level: 2, text: "å¥åº·è¿åŠ¿ï¼šé¢ˆæ¤éœ€è¦å…³æ³¨ï¼Œå°‘ä½å¤´çœ‹æ‰‹æœºï¼Œå¤šæŠ¬å¤´çœ‹è€æ¿åœ¨ä¸åœ¨ã€‚" },
                { level: 2, text: "ä»Šå¹´ä½ ä¼šæ˜ç™½ï¼šåƒé‡Œé©¬ä¹Ÿè¦åƒè‰ï¼Œä¸èƒ½å…‰å–è¥¿åŒ—é£â€”â€”è¥¿åŒ—é£ä¸ç®¡é¥±ã€‚" },
                { level: 2, text: "äº‹ä¸šä¸Šä¼šæœ‰å°æƒŠå–œï¼Œä½†æƒŠå–œå¾€å¾€ä¼´éšç€åŠ ç­â€”â€”æƒŠå–œæ˜¯é¡¹ç›®æˆäº†ï¼ŒæƒŠå“æ˜¯è¿å¤œä¸Šçº¿ã€‚" },
                { level: 2, text: "è´¢è¿æ–¹é¢ï¼Œå¯èƒ½ä¼šä¸­ä¸€æ¬¡å°å¥–â€”â€”æ¯”å¦‚å…¬å¸å¹´ä¼šæŠ½åˆ°é˜³å…‰æ™®ç…§å¥–ï¼ˆçº¸å·¾ä¸€ç›’ï¼‰ã€‚" },
                { level: 2, text: "æ„Ÿæƒ…è¿åŠ¿ï¼šå•èº«çš„æœ‰æœºä¼šè„±å•ï¼Œä½†è„±å•åå‘ç°è¿˜æ˜¯å•èº«çˆ½ã€‚" },
                { level: 2, text: "ä»Šå¹´ä½ ä¼šè§£é”ä¸€ä¸ªæ–°èº«ä»½ï¼šæœ‹å‹åœˆç¾é£Ÿåšä¸»ï¼Œè™½ç„¶åšçš„èœåªæœ‰è‡ªå·±æ•¢åƒã€‚" },
                { level: 2, text: "å¥åº·è¿åŠ¿ï¼šå¼€å§‹å…³æ³¨å…»ç”Ÿï¼Œä¿æ¸©æ¯é‡Œæ³¡æ¸æï¼Œè™½ç„¶ä¸çŸ¥é“æœ‰æ²¡æœ‰ç”¨ã€‚" },
                { level: 2, text: "ä»Šå¹´æœ€å¤§çš„æˆå°±æ˜¯ï¼šåœ¨çˆ¶æ¯çœ¼ä¸­ç»ˆäºâ€œç¨³å®šâ€äº†ï¼Œè™½ç„¶ä½ è‡ªå·±è§‰å¾—å¹¶ä¸ç¨³ã€‚" },
                { level: 2, text: "åƒé‡Œé©¬ï¼Œä»Šå¹´è¦å­¦ä¼šæ‹’ç»ï¼Œä¸ç„¶ä¼šç´¯æˆéª¡å­ã€‚" },
                { level: 2, text: "è´¢è¿æ–¹é¢ï¼Œå¯èƒ½ä¼šæœ‰ä¸€ç¬”é¢å¤–æ”¶å…¥ï¼Œä½†æ¥å¾—å¿«å»å¾—ä¹Ÿå¿«â€”â€”æ¯”å¦‚é€€ç¨ã€‚" },
                { level: 2, text: "æ„Ÿæƒ…ä¸Šï¼Œä¼šæœ‰ä¸€æ¬¡æµªæ¼«çš„çº¦ä¼šï¼Œåœ°ç‚¹å¯èƒ½æ˜¯ä½ å®¶æ¥¼ä¸‹çš„æ²™å¿å°åƒã€‚" },
                { level: 2, text: "ä»Šå¹´ä½ ä¼šçªç„¶å‘ç°ï¼šåŸæ¥è‡ªå·±è¿˜æŒºèƒ½æ‰›ï¼Œæ‰›å®Œè¿™æ³¢è¿˜æœ‰ä¸‹æ³¢ã€‚" },
                { level: 2, text: "åƒé‡Œé©¬ï¼Œé©¬å¹´ç¥ä½ ï¼šè·‘å¾—å¿«ï¼Œåƒå¾—é¥±ï¼Œä¼¯ä¹æ—©ç‚¹åˆ°ã€‚" },

                { level: 3, text: "ä»Šå¹´ä½ è¦æ‰“ä¸‰åœºç¡¬ä»—ï¼šå·¥ä½œã€å®¶åº­ã€è‡ªå·±â€”â€”æ‰“èµ¢ä¸¤åœºå°±ç®—èµ¢ã€‚" },
                { level: 3, text: "è´¢è¿ï¼šç¨³å®šï¼Œä½†ç¨³å®šåœ°ä¸å¤ŸèŠ±â€”â€”è¿™æ˜¯æˆå¹´äººçš„å¸¸æ€ï¼Œåˆ«æ…Œã€‚" },
                { level: 3, text: "æ„Ÿæƒ…è¿åŠ¿ï¼šè€å¤«è€å¦»æ¨¡å¼ï¼Œé»˜å¥‘åº¦+1ï¼Œæ¿€æƒ…-1ï¼Œä½†é»˜å¥‘æ¯”æ¿€æƒ…æ›´é•¿ä¹…ã€‚" },
                { level: 3, text: "äº‹ä¸šè¿åŠ¿ï¼šä½ ä¼šæˆä¸ºæŸä¸ªé¡¹ç›®çš„æ ¸å¿ƒï¼Œæ ¸å¿ƒ=å•¥éƒ½å¾—å¹²ï¼Œå¹²å®Œè¿˜å¾—èƒŒé”…ã€‚" },
                { level: 3, text: "è´µäººè¿ï¼šä½ çš„é˜Ÿå‹ï¼Œä»–ä»¬å¸®ä½ åˆ†æ‹…äº†50%çš„å·¥ä½œï¼Œä»¥åŠ100%çš„åæ§½ã€‚" },
                { level: 3, text: "å¥åº·è¿åŠ¿ï¼šè…°éœ€è¦å…³æ³¨ï¼Œæ¯•ç«Ÿè´Ÿé‡å‰è¡Œâ€”â€”å»ºè®®ä¹°ä¸ªå¥½çš„è…°é ã€‚" },
                { level: 3, text: "ä»Šå¹´æœ€å¤§çš„æˆå°±æ˜¯ï¼šåœ¨å´©æºƒè¾¹ç¼˜ç¨³ä½äº†ï¼Œç„¶åå‘ç°å´©æºƒä¹ŸæŒºç´¯çš„ã€‚" },
                { level: 3, text: "æ¡ƒèŠ±è¿ï¼šå·²å©šäººå£«è¯·å¿½ç•¥æ­¤æ¡ï¼Œå•èº«äººå£«è¯·ç»§ç»­å¿½ç•¥æ­¤æ¡ï¼ˆå› ä¸ºæ²¡ç©ºæ‹çˆ±ï¼‰ã€‚" },
                { level: 3, text: "æˆ˜é©¬ï¼Œä»Šå¹´è¦å­¦ä¼šè¯´â€œä¸â€ï¼Œä¸ç„¶çœŸçš„ä¼šç´¯æ­»â€”â€”è¯´â€œä¸â€ä¹‹åå‘ç°ï¼ŒåŸæ¥å¤©ä¸ä¼šå¡Œã€‚" },
                { level: 3, text: "è´¢åŠ¡ä¸Šä¼šæœ‰å¤§é¢æ”¯å‡ºï¼Œå¯èƒ½æ˜¯æˆ¿å­ã€è½¦å­ã€æˆ–è€…å­©å­â€”â€”ä½†éƒ½æ˜¯ç”œèœœçš„è´Ÿæ‹…ã€‚" },
                { level: 3, text: "ä»Šå¹´ä½ ä¼šçªç„¶æ„è¯†åˆ°ï¼šåŸæ¥çˆ¶æ¯å¼€å§‹ä¾èµ–ä½ äº†ï¼Œè¿™æ„Ÿè§‰æ—¢æ¸©æš–åˆå‹åŠ›å±±å¤§ã€‚" },
                { level: 3, text: "äº‹ä¸šä¸Šä¼šæœ‰ä¸€æ¬¡æ™‹å‡æœºä¼šï¼Œä½†æ™‹å‡åä¼šå‘ç°å·¥ä½œé‡ç¿»å€â€”â€”æ™‹å‡å¿«ä¹ï¼" },
                { level: 3, text: "è´¢è¿æ–¹é¢ï¼Œå¯èƒ½ä¼šæ”¶åˆ°ä¸€ç¬”è¿˜æ¬¾ï¼Œå¯¹æ–¹æ‹–äº†ä¸‰å¹´ç»ˆäºè¿˜äº†ï¼Œå€¼å¾—åº†ç¥ã€‚" },
                { level: 3, text: "æ„Ÿæƒ…è¿åŠ¿ï¼šå’Œä¼´ä¾£ä¸€èµ·åæ§½ç”Ÿæ´»ï¼Œæ˜¯æœ€å¥½çš„å¢è¿›æ„Ÿæƒ…æ–¹å¼ã€‚" },
                { level: 3, text: "å¥åº·è¿åŠ¿ï¼šå¼€å§‹é‡è§†ä½“æ£€ï¼Œè™½ç„¶ä½“æ£€å‰ç‘Ÿç‘Ÿå‘æŠ–ï¼Œä½“æ£€åé•¿èˆ’ä¸€å£æ°”ã€‚" },
                { level: 3, text: "ä»Šå¹´ä½ ä¼šæœ‰ä¸€ä¸ªæ–°å‘ç°ï¼šåŸæ¥å‘¨æœ«ç¡æ‡’è§‰æ˜¯æœ€å¥¢ä¾ˆçš„å¹¸ç¦ã€‚" },
                { level: 3, text: "æˆ˜é©¬ï¼Œä»Šå¹´ä½ çš„å…³é”®è¯æ˜¯â€œç¨³ä½â€â€”â€”ç¨³ä½å°±èƒ½èµ¢ï¼Œèµ¢äº†å°±èƒ½å–˜å£æ°”ã€‚" },
                { level: 3, text: "è´¢è¿æ–¹é¢ï¼Œå¯èƒ½ä¼šæœ‰ä¸€ç¬”æŠ•èµ„å›æŠ¥ï¼Œè™½ç„¶ä¸å¤šï¼Œä½†å¤Ÿåƒé¡¿å¥½çš„ã€‚" },
                { level: 3, text: "ä»Šå¹´ä½ ä¼šè¢«å«â€œå‰è¾ˆâ€ï¼Œè™½ç„¶ä½ è§‰å¾—æ˜¨å¤©è‡ªå·±è¿˜æ˜¯æ–°äººã€‚" },
                { level: 3, text: "æˆ˜é©¬ï¼Œé©¬å¹´ç¥ä½ ï¼šå†²é”‹æ—¶æœ‰äººé€’æ°´ï¼Œæ’¤é€€æ—¶æœ‰è‰åƒï¼Œèººå¹³æ—¶æ²¡äººåµã€‚" },

                { level: 4, text: "ä»Šå¹´ä½ ä¼šå¸¦é¢†å›¢é˜Ÿå®Œæˆä¸€ä¸ªå¤§é¡¹ç›®ï¼Œç„¶åå‘ç°ä¸å¦‚è‡ªå·±å¹²â€”â€”ä½†å›¢é˜Ÿä¼šè¯·ä½ åƒé¥­ã€‚" },
                { level: 4, text: "è´¢è¿ï¼šæ”¶å…¥ä¸é”™ï¼Œä½†æ”¯å‡ºæ›´å¤§â€”â€”å­©å­è¡¥ä¹ ç­ã€çˆ¶æ¯ä½“æ£€ã€æˆ¿è´·è½¦è´·ï¼Œé½äº†ã€‚" },
                { level: 4, text: "æ„Ÿæƒ…è¿åŠ¿ï¼šå®¶äººéœ€è¦ä½ å¤šé™ªä¼´ï¼Œåˆ«åªé¡¾ç€å¾€å‰å†²â€”â€”ä»–ä»¬æƒ³ä½ äº†ã€‚" },
                { level: 4, text: "äº‹ä¸šè¿åŠ¿ï¼šå¯èƒ½è¢«çŒå¤´æŒ–ï¼Œä½†æŒ–çš„å‘å¯èƒ½æ¯”ç°åœ¨æ·±â€”â€”å…ˆçœ‹çœ‹å‘é‡Œæœ‰æ²¡æœ‰è‰ã€‚" },
                { level: 4, text: "è´µäººè¿ï¼šä½ çš„ä¸‹å±ï¼Œä»–ä»¬æ‰›èµ·äº†æ‰€æœ‰ï¼Œä½ åªéœ€è¦è¯·ä»–ä»¬å–å¥¶èŒ¶ã€‚" },
                { level: 4, text: "å¥åº·è¿åŠ¿ï¼šè¡€å‹éœ€è¦å…³æ³¨ï¼Œå°‘ç”Ÿæ°”â€”â€”ç”Ÿæ°”çš„æ—¶å€™é»˜å¿µâ€œäº²ç”Ÿçš„ã€äº²é€‰çš„ã€äº²å¸¦çš„â€ã€‚" },
                { level: 4, text: "ä»Šå¹´æœ€å¤§çš„æ„Ÿæ‚Ÿï¼šé¢†å¤´é©¬ä¹Ÿä¸æ˜¯é‚£ä¹ˆå¥½å½“çš„â€”â€”ä½†å½“äº†å°±ä¸èƒ½æ€‚ã€‚" },
                { level: 4, text: "æ¡ƒèŠ±è¿ï¼šéƒ½é¢†å¤´é©¬äº†è¿˜æƒ³å•¥æ¡ƒèŠ±â€”â€”å®¶é‡Œé‚£æœµèŠ±éœ€è¦ä½ æµ‡çŒã€‚" },
                { level: 4, text: "ä»Šå¹´ä½ ä¼šé¢ä¸´ä¸€ä¸ªé€‰æ‹©ï¼šç»§ç»­è·‘ï¼Œè¿˜æ˜¯æ¢æ¡è·¯â€”â€”é€‰å“ªæ¡éƒ½å¯¹ï¼Œå› ä¸ºä½ æœ‰ç»éªŒã€‚" },
                { level: 4, text: "è´¢è¿æ–¹é¢ï¼ŒæŠ•èµ„éœ€è°¨æ…ï¼Œåˆ«ä¿¡ç†Ÿäººâ€”â€”ç†Ÿäººä¹Ÿå¯èƒ½äºã€‚" },
                { level: 4, text: "ä»Šå¹´ä½ ä¼šçªç„¶å‘ç°ï¼šå­©å­é•¿å¤§äº†ï¼Œä¼šé¡¶å˜´äº†â€”â€”è¿™æ˜¯æˆé•¿çš„æ ‡å¿—ï¼Œå¿ä½åˆ«æ‰“ã€‚" },
                { level: 4, text: "äº‹ä¸šä¸Šä¼šæœ‰ä¸€æ¬¡é«˜å…‰æ—¶åˆ»ï¼Œæ¯”å¦‚ä¸Šå°é¢†å¥–ï¼Œç„¶åå‘ç°å¥–æ¯æŒºæ²‰ã€‚" },
                { level: 4, text: "æ„Ÿæƒ…è¿åŠ¿ï¼šå’Œä¼´ä¾£ä¹‹é—´ä¼šæœ‰ä¸€æ¬¡æ·±åº¦èŠå¤©ï¼ŒèŠå®Œåå‘ç°è¿˜æ˜¯ä¸å¤ªæ‡‚å¯¹æ–¹â€”â€”ä½†æ›´äº²è¿‘äº†ã€‚" },
                { level: 4, text: "å¥åº·è¿åŠ¿ï¼šå¼€å§‹é”»ç‚¼èº«ä½“ï¼Œå› ä¸ºå‘ç°çˆ¬ä¸‰æ¥¼å¼€å§‹å–˜äº†ã€‚" },
                { level: 4, text: "ä»Šå¹´ä½ ä¼šè¢«å¹´è½»äººå«â€œè€å¸ˆâ€ï¼Œè™½ç„¶ä½ è§‰å¾—åªæ˜¯æ¯”ä»–ä»¬å¤šè¸©äº†å‡ ä¸ªå‘ã€‚" },
                { level: 4, text: "é¢†å¤´é©¬ï¼Œä»Šå¹´ä½ çš„å…³é”®è¯æ˜¯â€œå¹³è¡¡â€â€”â€”å¹³è¡¡å·¥ä½œå’Œå®¶åº­ï¼Œå¹³è¡¡ä»˜å‡ºå’Œå›æŠ¥ã€‚" },
                { level: 4, text: "è´¢è¿æ–¹é¢ï¼Œå¯èƒ½ä¼šæœ‰ä¸€ç¬”æ„å¤–ä¹‹è´¢ï¼Œæ¯”å¦‚é€€ç¨æˆ–è€…å¥–é‡‘â€”â€”å¤Ÿå…¨å®¶åƒé¡¿å¤§é¤ã€‚" },
                { level: 4, text: "ä»Šå¹´ä½ ä¼šæœ‰ä¸€ä¸ªæ–°èº«ä»½ï¼šå®¶é•¿ä¼šä»£è¡¨ï¼Œè™½ç„¶ä½ ä¹Ÿä¸çŸ¥é“å‡­ä»€ä¹ˆé€‰ä½ ã€‚" },
                { level: 4, text: "é¢†å¤´é©¬ï¼Œé©¬å¹´ç¥ä½ ï¼šå¸¦ç€å›¢é˜Ÿè·‘å¾—å¿«ï¼Œå›å®¶è¿˜èƒ½èµ¶å¾—ä¸Šçƒ­é¥­ã€‚" },
                { level: 4, text: "ä»Šå¹´æœ€å¤§çš„å¹¸ç¦ï¼šå¬åˆ°å®¶äººè¯´â€œä½ è¾›è‹¦äº†â€ï¼Œç„¶åä½ è¯´â€œä¸è¾›è‹¦ï¼Œå‘½è‹¦â€â€”â€”å¤§å®¶éƒ½ç¬‘äº†ã€‚" },

                { level: 5, text: "ä»Šå¹´ä½ ä¼šå‘ç°ï¼Œå¹´è½»æ—¶çº ç»“çš„äº‹ï¼Œç°åœ¨éƒ½ä¸å«äº‹â€”â€”å«æ•…äº‹ã€‚" },
                { level: 5, text: "è´¢è¿ï¼šç¨³å®šï¼Œå¼€å§‹äº«å—å­˜é’±çš„ä¹è¶£ï¼Œçœ‹ç€æ•°å­—å¢é•¿æ¯”èŠ±é’±è¿˜å¼€å¿ƒã€‚" },
                { level: 5, text: "æ„Ÿæƒ…è¿åŠ¿ï¼šè€ä¼´å„¿æ˜¯æœ€å¥½çš„è´µäººï¼Œé™ªä½ èµ°äº†è¿™ä¹ˆè¿œï¼Œè¿˜å¾—ç»§ç»­èµ°ã€‚" },
                { level: 5, text: "äº‹ä¸šè¿åŠ¿ï¼šç»éªŒå€¼æ‹‰æ»¡ï¼Œä½†ä½“åŠ›å€¼ä¸‹é™â€”â€”æ‰€ä»¥å¤šç”¨å˜´ï¼Œå°‘ç”¨è…¿ã€‚" },
                { level: 5, text: "è´µäººè¿ï¼šå¹´è½»äººï¼Œä»–ä»¬éœ€è¦ä½ å¸¦ï¼Œä½ ä¹Ÿéœ€è¦ä»–ä»¬è®©ä½ è§‰å¾—è‡ªå·±è¿˜å¹´è½»ã€‚" },
                { level: 5, text: "å¥åº·è¿åŠ¿ï¼šè…¿è„šéœ€è¦ä¿å…»ï¼Œå°‘è·‘å¤šèµ°ï¼Œèµ°ä¸åŠ¨å°±åä¼šå„¿ï¼Œæ²¡äººå‚¬ä½ ã€‚" },
                { level: 5, text: "ä»Šå¹´æœ€å¤§çš„å¹¸ç¦ï¼šçœ‹ç€å¹´è½»äººè¸©ä½ è¸©è¿‡çš„å‘ï¼Œç„¶åå¾®å¾®ä¸€ç¬‘ã€‚" },
                { level: 5, text: "æ¡ƒèŠ±è¿ï¼šå¤•é˜³çº¢ï¼Œä¹ŸæŒºç¾â€”â€”å¹¿åœºèˆè®¤è¯†çš„æ–°æœ‹å‹ï¼ŒèŠå¾—æ¥å°±è¡Œã€‚" },
                { level: 5, text: "è€é©¬ï¼Œä»Šå¹´é€‚åˆæ•´ç†è¿‡å¾€ï¼Œå†™å†™å›å¿†å½•â€”â€”å“ªæ€•åªå†™ç»™è‡ªå·±çœ‹ã€‚" },
                { level: 5, text: "è´¢è¿æ–¹é¢ï¼Œå¯èƒ½ä¼šæœ‰æ„å¤–ä¹‹è´¢ï¼Œæ¯”å¦‚å­å¥³ç»™çš„é›¶èŠ±é’±ï¼Œè™½ç„¶ä½ ä¸éœ€è¦ã€‚" },
                { level: 5, text: "ä»Šå¹´ä½ ä¼šçªç„¶å‘ç°ï¼šæ—¶é—´è¿‡å¾—çœŸå¿«ï¼Œä¸€çœ¨çœ¼å­©å­éƒ½è¿™ä¹ˆå¤§äº†â€”â€”ç„¶åå­©å­è¯´ä½ åˆæ„Ÿæ…¨äº†ã€‚" },
                { level: 5, text: "äº‹ä¸šä¸Šï¼Œä½ å¯èƒ½å·²ç»ä¸éœ€è¦è¯æ˜ä»€ä¹ˆäº†ï¼Œåšè‡ªå·±å–œæ¬¢çš„äº‹æœ€é‡è¦ã€‚" },
                { level: 5, text: "æ„Ÿæƒ…è¿åŠ¿ï¼šå’Œè€ä¼´å„¿ä¸€èµ·å›å¿†å¹´è½»æ—¶çš„å‚»äº‹ï¼Œç¬‘å‡ºçœ¼æ³ªã€‚" },
                { level: 5, text: "å¥åº·è¿åŠ¿ï¼šä½“æ£€æŒ‡æ ‡æœ‰é«˜æœ‰ä½ï¼Œä½†å¿ƒæ€å¹³å’Œæœ€é‡è¦â€”â€”é«˜å°±é«˜ç‚¹ï¼Œä½å°±ä½ç‚¹ã€‚" },
                { level: 5, text: "ä»Šå¹´ä½ ä¼šè¢«æ™šè¾ˆè¯·æ•™å„ç§é—®é¢˜ï¼Œè™½ç„¶ä½ ä¹Ÿä¸çŸ¥é“ç­”æ¡ˆï¼Œä½†å‡­ç»éªŒèƒ½è’™å¯¹ä¸€åŠã€‚" },
                { level: 5, text: "è€é©¬ï¼Œä»Šå¹´ä½ çš„å…³é”®è¯æ˜¯â€œäº«å—â€â€”â€”äº«å—ç”Ÿæ´»ï¼Œäº«å—å¤©ä¼¦ä¹‹ä¹ï¼Œäº«å—æ…¢ä¸‹æ¥çš„æ—¥å­ã€‚" },
                { level: 5, text: "è´¢è¿æ–¹é¢ï¼Œé€‚åˆç»™è‡ªå·±èŠ±ç‚¹é’±ï¼Œä¹°ä¸ªä¸€ç›´æƒ³ä¹°ä½†èˆä¸å¾—ä¹°çš„ä¸œè¥¿ã€‚" },
                { level: 5, text: "ä»Šå¹´ä½ ä¼šæœ‰ä¸€ä¸ªæ–°çˆ±å¥½ï¼šå…»èŠ±ã€å…»é±¼ã€æˆ–è€…å…»å­™å­â€”â€”éƒ½æŒºè´¹ç²¾åŠ›ï¼Œä½†ä¹åœ¨å…¶ä¸­ã€‚" },
                { level: 5, text: "è€é©¬è¯†é€”ï¼Œä¸ç”¨å†èµ¶è·¯ã€‚é©¬å¹´æ„¿ä½ ï¼šèµ°å¾—æ…¢ä¸€ç‚¹ï¼Œçœ‹å¾—æ¸…ä¸€ç‚¹ï¼Œç¬‘å¾—çœŸä¸€ç‚¹ã€‚" },
                { level: 5, text: "ä»Šå¹´ä½ ä¼šçªç„¶è§‰å¾—â€”â€”è¿™è¾ˆå­ï¼Œå€¼äº†ã€‚ä¸æ˜¯å› ä¸ºæ²¡æœ‰é—æ†¾ï¼Œè€Œæ˜¯å› ä¸ºé—æ†¾ä¹Ÿæ˜¯é£æ™¯ã€‚" }
            ];

            // é»˜è®¤æ¸…å•æ•°æ®ï¼ˆ8ä¸ªå…³å¡ï¼‰
            const DEFAULT_CHAPTERS = [
                {
                    icon: "ğŸ¼",
                    name: "ç¬¬ä¸€å…³ï¼šæ–°æ‰‹æ‘ä»»åŠ¡",
                    tasks: [
                        "å‡ºç”Ÿ â€”â€” æˆåŠŸç™»å½•åœ°çƒæœåŠ¡å™¨",
                        "ç¬¬ä¸€æ¬¡å“­ â€”â€” é¦–åœºå…¬å¼€æ¼”å‡º",
                        "å­¦ä¼šèµ°è·¯ â€”â€” æ­¤åä¸€ç”Ÿéƒ½åœ¨è¿½é€",
                        "ç¬¬ä¸€æ¬¡å«å¦ˆ â€”â€” è§£é”äººç±»è¯­éŸ³åŒ…",
                        "æ¢ç‰™ â€”â€” ç‰™é½¿äº¤ç»™æ•å¤´ï¼Œæ¢æ¥ä¸€æšç¡¬å¸"
                    ]
                },
                {
                    icon: "ğŸ“š",
                    name: "ç¬¬äºŒå…³ï¼šæ ¡å›­å‰¯æœ¬",
                    tasks: [
                        "ä¸Šå°å­¦ â€”â€” èƒŒä¸Šäº†æ¯”æ¢¦æƒ³è¿˜æ²‰çš„ä¹¦åŒ…",
                        "ç¬¬ä¸€æ¬¡è€ƒè¯• â€”â€” ç†è§£ä¸´æ—¶æŠ±ä½›è„šæ˜¯ä¸€é—¨å­¦ç§‘",
                        "æ¯•ä¸š â€”â€” æ‹¿åˆ°ç¤¾ä¼šå…¥åœºåˆ¸",
                        "åŒå­¦å½• â€”â€” å†™è¿‡æ°¸è¿œåšæœ‹å‹",
                        "æš—æ‹ â€”â€” æ¯•ä¸šä¹Ÿæ²¡è¯´å‡ºå£"
                    ]
                },
                {
                    icon: "ğŸ’¼",
                    name: "ç¬¬ä¸‰å…³ï¼šç¤¾ä¼šç”Ÿå­˜æ¨¡å¼",
                    tasks: [
                        "ç¬¬ä¸€ä»½å·¥ä½œ â€”â€” æ”¹å˜ä¸–ç•Œå’Œæ”¹PPTæ˜¯åŒä¸€ä»¶äº‹",
                        "ç¬¬ä¸€æ¬¡å‘å·¥èµ„ â€”â€” ç»™çˆ¸å¦ˆå‘çº¢åŒ…/è¯·æœ‹å‹åƒé¥­",
                        "ç¬¬ä¸€æ¬¡è·³æ§½ â€”â€” å­¦ä¼šå†™ä¸ªäººå‘å±•è§„åˆ’",
                        "ç¬¬ä¸€æ¬¡è¢«è£/è£¸è¾ â€”â€” æˆå°±ï¼šç»ˆäºç¡å¤Ÿäº†",
                        "ç§Ÿæˆ¿ â€”â€” æ¬è¿‡3æ¬¡å®¶ä»¥ä¸Š",
                        "ç¬¬ä¸€æ¬¡ç‹¬ç«‹å¤„ç†å¤§äº‹ â€”â€” åŠè¯ä»¶/ä¿®æ°´ç®¡/æ·±å¤œæ€¥è¯Š"
                    ]
                },
                {
                    icon: "ğŸ’",
                    name: "ç¬¬å››å…³ï¼šäººç±»ç»‘å®šä»»åŠ¡",
                    tasks: [
                        "ç¬¬ä¸€æ¬¡å¿ƒåŠ¨ â€”â€” é‚£å¹´å¤å¤©ï¼Œä»¥ä¸ºè¿™ä¸ªäººå°±æ˜¯å…¨éƒ¨",
                        "ç¬¬ä¸€æ¬¡å¤±æ‹ â€”â€” ä¸–ç•Œæ²¡å¡Œï¼Œåªæ˜¯å˜ç°äº†",
                        "é‡åˆ°æƒ³å…±åº¦ä½™ç”Ÿçš„äºº â€”â€” è¿™æ¬¡æ˜¯çœŸçš„",
                        "ç»“å©š â€”â€” åœ¨é¢†ä¸ªè¯å’ŒåŠåœºæˆä¹‹é—´å®Œæˆåšå¼ˆ",
                        "åº¦èœœæœˆï¼ˆå“ªæ€•åªæ˜¯å»äº†éš”å£å¸‚ï¼‰"
                    ]
                },
                {
                    icon: "ğŸ‘¶",
                    name: "ç¬¬äº”å…³ï¼šäººç±»å¤åˆ¶ä»»åŠ¡",
                    tasks: [
                        "å¤‡å­• â€”â€” è®¤çœŸå¾—åƒåœ¨å‡†å¤‡é«˜è€ƒ",
                        "ç¬¬ä¸€æ¬¡å½“çˆ¶æ¯ â€”â€” ç†è®ºæ»¡åˆ†ï¼Œå®æˆ˜æ‰‹å¿™è„šä¹±",
                        "ç¬¬ä¸€æ¬¡æ¢å°¿å¸ƒ â€”â€” è¢«æ»‹äº†ä¸€è„¸ï¼Œè¿˜ç¬‘äº†",
                        "ç¬¬ä¸€æ¬¡å®¶é•¿ä¼š â€”â€” åè¿›å°æ¤…å­ï¼Œç†è§£äº†å½“å¹´çš„è€å¸ˆ",
                        "è¾…å¯¼ä½œä¸š â€”â€” è¡€å‹æ­£å¸¸ï¼Œå°šåœ¨å®‰å…¨åŒº"
                    ]
                },
                {
                    icon: "ğŸš",
                    name: "ç¬¬å…­å…³ï¼šç”Ÿå­˜å½©è›‹",
                    tasks: [
                        "è¯´èµ°å°±èµ°çš„æ—…è¡Œ â€”â€” å“ªæ€•åªæ˜¯å»äº†éš”å£çœ",
                        "é€šå®µ â€”â€” ä¸æ˜¯ç©ï¼Œæ˜¯çœŸçš„ç¡ä¸ç€",
                        "ä¸€ä¸ªäººåƒç«é”…/çœ‹ç”µå½±/å»åŒ»é™¢",
                        "å•¥ä¹Ÿä¸é¡¾çš„æ—…è¡Œ â€”â€” å…³å·¥ä½œç¾¤ã€ä¸æŸ¥æ”»ç•¥ã€ä¸ä¸ºå‘æœ‹å‹åœˆ",
                        "å­¦ä¼šæ‹’ç» â€”â€” å©‰æ‹’è¿‡ä¸‰æ¬¡æ¨é”€ç”µè¯ä¹Ÿç®—"
                    ]
                },
                {
                    icon: "ğŸ ",
                    name: "ç¬¬ä¸ƒå…³ï¼šå®¶åº­å²è¯—ä»»åŠ¡",
                    tasks: [
                        "ç¬¬ä¸€æ¬¡ç»™çˆ¶æ¯ä¹°ä¸œè¥¿ â€”â€” ä»–ä»¬å˜´ä¸Šè¯´ä¹±èŠ±é’±ï¼Œæœ‹å‹åœˆå‘äº†ä¸‰å¤©",
                        "ç¬¬ä¸€æ¬¡å¸¦çˆ¶æ¯ä½“æ£€ â€”â€” æ”¥ç€æŠ¥å‘Šå•ä¸æ•¢æ‰“å¼€",
                        "è£…ä¿® â€”â€” å’Œè£…ä¿®å…¬å¸åµæ¶ç»éªŒå€¼+100",
                        "ç¬¬ä¸€æ¬¡å¤„ç†å®¶åº­å¤§äº‹ â€”â€” å‘ç°è‡ªå·±ä¸å†æ˜¯ç­‰å®‰æ’çš„å°å­©",
                        "æˆä¸ºçˆ¶æ¯çš„éª„å‚² â€”â€” ä»–ä»¬è§‰å¾—å·²ç»æ˜¯ï¼Œä½ è¿˜è§‰å¾—ä¸å¤Ÿ"
                    ]
                },
                {
                    icon: "ğŸŒ³",
                    name: "ç¬¬å…«å…³ï¼šç»ˆå±€å½©è›‹",
                    tasks: [
                        "ç«‹é—å˜± â€”â€” å…¶å®æ˜¯æ‰‹æœºå¤‡å¿˜å½•ï¼šæŠŠæˆ‘å¾®ä¿¡æ”¶è—å¤¹åˆ æ‰",
                        "å®Œæˆä¸€ä¸ªå¹´è½»æ—¶å¹è¿‡çš„ç‰› â€”â€” å“ªæ€•åªæœ‰åŠä¸ª",
                        "å’Œæ‰€æœ‰åœ¨æ„çš„äººå’Œå¥½/å‘Šåˆ« â€”â€” ä¸æ€¥ï¼Œä½†è®°åœ¨å¿ƒé‡Œ",
                        "æµè§ˆå™¨å†å²è®°å½•å·²æ¸…ç©º â€”â€” æ¯ä¸ªäººéƒ½æœ‰è‡ªå·±çš„ç§˜å¯†èŠ±å›­",
                        "è‡ªåŠ¨ç»­è´¹å·²å…¨éƒ¨å–æ¶ˆ â€”â€” äººç”Ÿæœ€åä¸€æ¬¡å…³æ‰ä¼šå‘˜",
                        "å¯¹è‡ªå·±è¯´ï¼šè¿™ä¸€å±€ï¼Œç©å¾—è¿˜ä¸é”™"
                    ]
                }
            ];

            // çŠ¶æ€ç®¡ç†
            let chapters = [];
            let expandedState = {};
            let checkedState = [];
            let currentEditChapter = null;
            let currentEditTask = null;
            let rollingTimer = null;
            let pendingDeleteChapter = null;

            // DOM å…ƒç´ 
            const chapterList = document.getElementById('chapterList');
            const selectedCountSmall = document.getElementById('selectedCountSmall');
            const totalCountSmall = document.getElementById('totalCountSmall');
            const progressFill = document.getElementById('progressFill');
            const percentDisplay = document.getElementById('percentDisplay');
            const percentBadge = document.getElementById('percentBadge');
            const generateBtn = document.getElementById('generateBtn');
            const toast = document.getElementById('toast');
            const firework = document.getElementById('firework');
            const exportBtn = document.getElementById('exportBtn');
            const importBtn = document.getElementById('importBtn');
            const resetBtn = document.getElementById('resetBtn');
            const addChapterBtn = document.getElementById('addChapterBtn');
            const deleteModal = document.getElementById('deleteModal');
            const cancelDelete = document.getElementById('cancelDelete');
            const confirmDelete = document.getElementById('confirmDelete');
            const wisdomTip = document.getElementById('wisdomTip');

            const revealBtn = document.getElementById('reveal-horse-btn');
            const horseResult = document.getElementById('horse-result');
            const rollingArea = document.getElementById('rolling-area');
            const resultDisplay = document.getElementById('result-display');
            const resultHorseName = document.getElementById('result-horse-name');
            const resultHorseDesc = document.getElementById('result-horse-desc');
            const resultFortune = document.getElementById('result-fortune');
            const retestBtn = document.getElementById('retest-btn');
            const shareBtn = document.getElementById('share-result-btn');

            // ç­‰çº§é¢„è§ˆç›¸å…³å…ƒç´ å·²åˆ é™¤ï¼Œä¸å†è·å–

            const progressModule = document.getElementById('progress-module');
            const stickyContainer = document.getElementById('sticky-progress-container');
            const stickyProgressModule = document.getElementById('sticky-progress-module');
            const progressCountSpan = document.getElementById('progressCount');

            // ========== æ•°æ®æŒä¹…åŒ– ==========
            const STORAGE_KEY = 'maYearChecklist';
            
            function saveToLocalStorage() {
                const data = {
                    chapters: chapters,
                    checkedState: checkedState,
                    expandedState: expandedState
                };
                localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
            }

            function loadFromLocalStorage() {
                const saved = localStorage.getItem(STORAGE_KEY);
                if (saved) {
                    try {
                        const data = JSON.parse(saved);
                        if (data.chapters && Array.isArray(data.chapters)) {
                            chapters = data.chapters;
                            checkedState = data.checkedState || [];
                            expandedState = data.expandedState || {};
                            // ç¡®ä¿checkedStateé•¿åº¦ä¸ä»»åŠ¡æ€»æ•°ä¸€è‡´
                            const totalTasks = chapters.reduce((sum, ch) => sum + ch.tasks.length, 0);
                            if (checkedState.length !== totalTasks) {
                                // å¦‚æœä¸ä¸€è‡´ï¼Œé‡æ–°åˆå§‹åŒ–checkedState
                                checkedState = new Array(totalTasks).fill(false);
                            }
                            // ç¡®ä¿æ¯ä¸ªç« èŠ‚åœ¨expandedStateä¸­æœ‰è®°å½•ï¼Œé»˜è®¤æŠ˜å 
                            chapters.forEach((_, idx) => {
                                if (expandedState[idx] === undefined) expandedState[idx] = false;
                            });
                            return true;
                        }
                    } catch (e) {
                        console.warn('è¯»å–æœ¬åœ°å­˜å‚¨å¤±è´¥', e);
                    }
                }
                return false;
            }

            // åˆå§‹åŒ–æ•°æ®
            function initData() {
                if (!loadFromLocalStorage()) {
                    // æ— æœ¬åœ°å­˜å‚¨ï¼Œä½¿ç”¨é»˜è®¤
                    chapters = JSON.parse(JSON.stringify(DEFAULT_CHAPTERS));
                    // é»˜è®¤æ‰€æœ‰å…³å¡æŠ˜å 
                    chapters.forEach((_, idx) => { expandedState[idx] = false; });

                    let taskIndex = 0;
                    chapters.forEach(chapter => {
                        chapter.tasks.forEach(() => {
                            checkedState[taskIndex] = false;
                            taskIndex++;
                        });
                    });
                }
            }

            // è·å–å…³å¡è¿›åº¦
            function getChapterCheckedCount(chapterIdx) {
                let start = 0;
                for (let i = 0; i < chapterIdx; i++) {
                    start += chapters[i].tasks.length;
                }
                let count = 0;
                for (let i = 0; i < chapters[chapterIdx].tasks.length; i++) {
                    if (checkedState[start + i]) count++;
                }
                return count;
            }

            // è·å–é©¬ç­‰çº§
            function getHorseLevel(percent) {
                if (percent < 20) return { name: "å°é©¬é©¹", desc: "åˆç”Ÿç‰›çŠŠä¸æ€•è™" };
                if (percent < 40) return { name: "åƒé‡Œé©¬", desc: "ä¼¯ä¹åœ¨è·¯ä¸Šäº†" };
                if (percent < 60) return { name: "æˆ˜é©¬", desc: "æ­£åœ¨å†²é”‹é™·é˜µ" };
                if (percent < 80) return { name: "é¢†å¤´é©¬", desc: "åé¢è·Ÿç€ä¸€ä¸²" };
                return { name: "è€é©¬è¯†é€”", desc: "è¿™è¾ˆå­æ²¡ç™½è·‘" };
            }

            // æ›´æ–°è¿›åº¦
            function updateProgress() {
                const total = checkedState.length;
                const checked = checkedState.filter(v => v).length;
                const percent = total === 0 ? 0 : Math.round((checked / total) * 100);

                progressCountSpan.textContent = `${checked}/${total}`;
                progressFill.style.width = percent + '%';
                percentDisplay.textContent = percent;
                percentBadge.textContent = percent + '%';

                selectedCountSmall.textContent = checked;
                totalCountSmall.textContent = total;

                // ç­‰çº§é¢„è§ˆå·²åˆ é™¤ï¼Œä¸å†æ›´æ–°ç›¸å…³å…ƒç´ 

                // æ›´æ–°æ¸©é¦¨æç¤º
                if (percent < 20) wisdomTip.innerHTML = 'ğŸŒ± æ‰åˆšå¼€å§‹å‘¢ï¼Œåƒå°é©¬é©¹ä¸€æ ·æ¬¢å¿«åœ°å¥”è·‘å§ï½';
                else if (percent < 40) wisdomTip.innerHTML = 'ğŸ¼ äººç”Ÿè¿›åº¦20%+ï¼Œæ­£æ˜¯è¯»ä¹¦å¥½æ—¶èŠ‚ã€‚';
                else if (percent < 60) wisdomTip.innerHTML = 'ğŸ’¼ è¿›åº¦è¿‡åŠï¼åƒé©¬å„¿ä¸€æ ·ï¼Œè·‘ç´¯äº†å°±åœä¸‹æ¥åƒè‰ã€‚';
                else if (percent < 80) wisdomTip.innerHTML = 'ğŸ  70%+ï¼Œå®¶çš„æ„ä¹‰è¶Šæ¥è¶Šé‡ã€‚';
                else if (percent < 100) wisdomTip.innerHTML = 'â­ å¿«åœ†æ»¡äº†ï¼é©¬å¹´æ„¿ä½ å‰©ä¸‹çš„æ¯ä¸€æ­¥éƒ½è¸åœ¨å–œæ¬¢çš„è·¯ä¸Šã€‚';
                else wisdomTip.innerHTML = 'ğŸ‰ 100%ï¼é©¬åˆ°æˆåŠŸï¼è¿™ä¸€å±€ï¼Œä½ ç©å¾—å¾ˆæ¼‚äº®ã€‚';

                // çƒŸèŠ±æ•ˆæœ
                if (percent === 100 && total > 0) {
                    firework.classList.add('show');
                    setTimeout(() => firework.classList.remove('show'), 1500);
                    document.querySelector('.snow-header h2 span').innerHTML = 'ğŸ´ é©¬åˆ°æˆåŠŸï¼äººç”Ÿåœ†æ»¡ ğŸ‰';
                } else {
                    document.querySelector('.snow-header h2 span').innerHTML = 'ğŸ´ é©¬å¹´çœ‹çœ‹ä½ æ˜¯ä»€ä¹ˆé©¬ï¼Ÿ';
                }

                updateStickyProgress();
            }

            // æ›´æ–°ç½®é¡¶è¿›åº¦æ¡ï¼ˆä¿®æ”¹ä¸ºä»wisdomTipè·å–åŠ¨æ€æ–‡æœ¬ï¼‰
            function updateStickyProgress() {
                if (!stickyProgressModule) return;
                const total = checkedState.length;
                const checked = checkedState.filter(v => v).length;
                const percent = total === 0 ? 0 : Math.round((checked / total) * 100);
                // ä»ä¸»è¿›åº¦æ¡çš„wisdomTipè·å–æ–‡æœ¬
                const tipText = wisdomTip ? wisdomTip.innerText : 'ğŸŒ± æ…¢æ…¢æ¥ï¼Œæ¯ä¸€æ­¥éƒ½ç®—æ•°ã€‚';

                stickyProgressModule.innerHTML = `
                    <div class="progress-title">
                        <span>ğŸ§§ é©¬å¹´å·²è§£é”äººç”Ÿå…³å¡</span>
                        <span class="stats-number">${checked}/${total}</span>
                    </div>
                    <div class="progress-bar-bg">
                        <div class="progress-fill" style="width: ${percent}%;"></div>
                    </div>
                    <div class="progress-stats">
                        <span>ğŸ é©¬å¹´è¿›åº¦</span>
                        <span>${percent}%</span>
                    </div>
                    <div class="wisdom-tip" style="margin-top: 8px; padding: 8px 12px;">
                        ${tipText}
                    </div>
                `;
            }

            // ç½®é¡¶æ»šåŠ¨ç›‘å¬
            function setupStickyScroll() {
                let ticking = false;
                window.addEventListener('scroll', () => {
                    if (!ticking) {
                        window.requestAnimationFrame(() => {
                            const rect = progressModule.getBoundingClientRect();
                            stickyContainer.style.display = rect.top < 0 ? 'block' : 'none';
                            ticking = false;
                        });
                        ticking = true;
                    }
                });
            }

            // ç”ŸæˆäºŒç»´ç 
            function generateQRCode() {
                const grid = document.getElementById('qrcode-grid');
                if (!grid) return;
                let html = '';
                for (let i = 0; i < 49; i++) {
                    const isBlack = Math.random() > 0.5;
                    html += `<div class="qrcode-cell ${isBlack ? 'black' : ''}"></div>`;
                }
                grid.innerHTML = html;
            }

            // æ¸²æŸ“å…³å¡
            function renderChapters() {
                let html = '';

                chapters.forEach((chapter, chapterIdx) => {
                    const isExpanded = expandedState[chapterIdx];
                    const chapterChecked = getChapterCheckedCount(chapterIdx);
                    const chapterTotal = chapter.tasks.length;
                    const isEditingTitle = (currentEditChapter === chapterIdx);

                    html += `<div class="chapter-card ${isEditingTitle ? 'editing-title' : ''}" data-chapter="${chapterIdx}">`;

                    // å¤´éƒ¨
                    html += `<div class="chapter-header" onclick="window.toggleChapter(${chapterIdx})">`;
                    html += `<div class="chapter-header-left">`;
                    html += `<span class="chapter-icon">${chapter.icon}</span>`;
                    html += `<span class="chapter-title" ondblclick="event.stopPropagation(); window.editChapterTitle(${chapterIdx})">${chapter.name}</span>`;
                    html += `<input type="text" class="chapter-title-edit" value="${chapter.name}" onblur="window.saveChapterTitleEdit(${chapterIdx}, this.value)" onkeypress="if(event.key==='Enter'){this.blur();}">`;
                    html += `<span class="chapter-progress">${chapterChecked}/${chapterTotal}</span>`;
                    html += `<span class="chapter-toggle ${isExpanded ? '' : 'collapsed'}">${isExpanded ? 'â–¼' : 'â–¶'}</span>`;
                    html += `</div></div>`;

                    // æ“ä½œæŒ‰é’®
                    html += `<div class="chapter-actions ${isExpanded ? '' : 'collapsed'}">`;
                    html += `<button class="chapter-btn" onclick="event.stopPropagation(); window.completeChapter(${chapterIdx})">âœ… ä¸€é”®å®Œæˆ</button>`;
                    html += `<button class="chapter-btn" onclick="event.stopPropagation(); window.addTask(${chapterIdx})">â• æ–°å¢ä»»åŠ¡</button>`;
                    html += `<button class="chapter-btn delete" onclick="event.stopPropagation(); window.showDeleteModal(${chapterIdx})">ğŸ—‘ï¸ åˆ é™¤å…³å¡</button>`;
                    html += `</div>`;

                    // ä»»åŠ¡åˆ—è¡¨
                    html += `<div class="task-list ${isExpanded ? '' : 'collapsed'}">`;

                    chapter.tasks.forEach((task, taskIdx) => {
                        let globalIdx = 0;
                        for (let i = 0; i < chapterIdx; i++) globalIdx += chapters[i].tasks.length;
                        globalIdx += taskIdx;

                        const isChecked = checkedState[globalIdx] ? 'checked' : '';
                        const isEditingTask = (currentEditTask && currentEditTask.chapter === chapterIdx && currentEditTask.task === taskIdx);

                        html += `<div class="task-item ${isEditingTask ? 'editing' : ''}" id="task-${chapterIdx}-${taskIdx}">`;
                        html += `<input type="checkbox" id="task_${chapterIdx}_${taskIdx}" data-chapter="${chapterIdx}" data-task="${taskIdx}" data-global="${globalIdx}" ${isChecked}>`;
                        html += `<label for="task_${chapterIdx}_${taskIdx}" class="task-label" ondblclick="window.editTask(${chapterIdx}, ${taskIdx})">${task}</label>`;
                        html += `<input type="text" class="task-edit-input" value="${task}" onblur="window.saveTaskEdit(${chapterIdx}, ${taskIdx}, this.value)" onkeypress="if(event.key==='Enter'){this.blur();}">`;
                        html += `<button class="task-delete" onclick="window.deleteTask(${chapterIdx}, ${taskIdx})">âœ•</button>`;
                        html += `</div>`;
                    });

                    html += `</div></div>`;
                });

                chapterList.innerHTML = html;

                // ç»‘å®šå¤é€‰æ¡†äº‹ä»¶
                document.querySelectorAll('.task-item input[type="checkbox"]').forEach(checkbox => {
                    checkbox.addEventListener('change', function() {
                        const globalIdx = parseInt(this.dataset.global);
                        checkedState[globalIdx] = this.checked;
                        updateProgress();
                        saveToLocalStorage(); // ä¿å­˜

                        const chapterIdx = parseInt(this.dataset.chapter);
                        const checked = getChapterCheckedCount(chapterIdx);
                        const total = chapters[chapterIdx].tasks.length;
                        const progressSpan = document.querySelector(`.chapter-card[data-chapter="${chapterIdx}"] .chapter-progress`);
                        if (progressSpan) progressSpan.textContent = `${checked}/${total}`;
                    });
                });
            }

            // ========== ç¼–è¾‘åŠŸèƒ½ ==========
            window.toggleChapter = function(chapterIdx) {
                expandedState[chapterIdx] = !expandedState[chapterIdx];
                renderChapters();
                saveToLocalStorage(); // ä¿å­˜æŠ˜å çŠ¶æ€
            };

            window.editChapterTitle = function(chapterIdx) {
                currentEditChapter = chapterIdx;
                renderChapters();
                setTimeout(() => {
                    document.querySelector(`.chapter-card[data-chapter="${chapterIdx}"] .chapter-title-edit`)?.focus();
                }, 50);
            };

            window.saveChapterTitleEdit = function(chapterIdx, newText) {
                if (newText.trim()) chapters[chapterIdx].name = newText.trim();
                currentEditChapter = null;
                renderChapters();
                saveToLocalStorage(); // ä¿å­˜
            };

            window.editTask = function(chapterIdx, taskIdx) {
                currentEditTask = { chapter: chapterIdx, task: taskIdx };
                renderChapters();
                setTimeout(() => {
                    document.querySelector(`#task-${chapterIdx}-${taskIdx} .task-edit-input`)?.focus();
                }, 50);
            };

            window.saveTaskEdit = function(chapterIdx, taskIdx, newText) {
                if (newText.trim()) chapters[chapterIdx].tasks[taskIdx] = newText.trim();
                currentEditTask = null;
                renderChapters();
                saveToLocalStorage(); // ä¿å­˜
            };

            window.deleteTask = function(chapterIdx, taskIdx) {
                if (confirm('ç¡®å®šåˆ é™¤è¿™ä¸ªä»»åŠ¡å—ï¼Ÿ')) {
                    chapters[chapterIdx].tasks.splice(taskIdx, 1);
                    let newChecked = [];
                    chapters.forEach(c => c.tasks.forEach(() => newChecked.push(false)));
                    for (let i = 0; i < Math.min(checkedState.length, newChecked.length); i++) newChecked[i] = checkedState[i];
                    checkedState = newChecked;
                    renderChapters();
                    updateProgress();
                    saveToLocalStorage(); // ä¿å­˜
                }
            };

            window.completeChapter = function(chapterIdx) {
                let start = 0;
                for (let i = 0; i < chapterIdx; i++) start += chapters[i].tasks.length;
                for (let i = 0; i < chapters[chapterIdx].tasks.length; i++) checkedState[start + i] = true;
                renderChapters();
                updateProgress();
                saveToLocalStorage(); // ä¿å­˜
            };

            window.addTask = function(chapterIdx) {
                const task = prompt('è¯·è¾“å…¥æ–°ä»»åŠ¡ï¼š');
                if (task?.trim()) {
                    chapters[chapterIdx].tasks.push(task.trim());
                    let newChecked = [];
                    chapters.forEach(c => c.tasks.forEach(() => newChecked.push(false)));
                    for (let i = 0; i < Math.min(checkedState.length, newChecked.length); i++) newChecked[i] = checkedState[i];
                    checkedState = newChecked;
                    renderChapters();
                    updateProgress();
                    saveToLocalStorage(); // ä¿å­˜
                }
            };

            window.showDeleteModal = function(chapterIdx) {
                pendingDeleteChapter = chapterIdx;
                deleteModal.classList.add('show');
            };

            // ========== å¯¼å‡º/å¯¼å…¥/é‡ç½® ==========
            function exportChecklist() {
                // å¢å¼ºå…ƒä¿¡æ¯ï¼šæ·»åŠ ç‰ˆæœ¬å’Œå¯¼å‡ºæ—¶é—´
                const data = { 
                    chapters, 
                    checked: checkedState,
                    version: '1.0',
                    exportTime: new Date().toISOString()
                };
                const blob = new Blob([JSON.stringify(data)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `é©¬å¹´æ¸…å•-${new Date().toISOString().slice(0,10)}.json`;
                a.click();
                showToast('å¯¼å‡ºæˆåŠŸ');
            }

            function importChecklist() {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = '.json';
                input.onchange = (e) => {
                    const file = e.target.files[0];
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        try {
                            const data = JSON.parse(e.target.result);
                            if (data.chapters) {
                                chapters = data.chapters;
                                checkedState = data.checked || [];
                                // é‡ç½®æŠ˜å çŠ¶æ€ä¸ºé»˜è®¤æŠ˜å 
                                chapters.forEach((_, idx) => { expandedState[idx] = false; });
                                renderChapters();
                                updateProgress();
                                saveToLocalStorage(); // ä¿å­˜
                                showToast('å¯¼å…¥æˆåŠŸ');
                            } else {
                                alert('æ–‡ä»¶æ ¼å¼é”™è¯¯');
                            }
                        } catch (err) {
                            alert('æ–‡ä»¶è§£æå¤±è´¥');
                        }
                    };
                    reader.readAsText(file);
                };
                input.click();
            }

            function resetChecklist() {
                if (confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰æ¸…å•å—ï¼Ÿå½“å‰è¿›åº¦å°†ä¸¢å¤±ã€‚')) {
                    chapters = JSON.parse(JSON.stringify(DEFAULT_CHAPTERS));
                    chapters.forEach((_, idx) => { expandedState[idx] = false; }); // æŠ˜å 
                    checkedState = [];
                    chapters.forEach(c => c.tasks.forEach(() => checkedState.push(false)));
                    renderChapters();
                    updateProgress();
                    saveToLocalStorage(); // ä¿å­˜
                    showToast('å·²é‡ç½®');
                }
            }

            // ========== é©¬å¹´ç»“æœ ==========
            function startRolling() {
                horseResult.style.display = 'block';
                rollingArea.style.display = 'block';
                resultDisplay.style.display = 'none';

                const words = ['ğŸ´ å°é©¬é©¹', 'ğŸ‡ åƒé‡Œé©¬', 'âš”ï¸ æˆ˜é©¬', 'ğŸ‘‘ é¢†å¤´é©¬', 'ğŸ§“ è€é©¬è¯†é€”'];
                let count = 0;
                if (rollingTimer) clearInterval(rollingTimer);
                rollingTimer = setInterval(() => {
                    rollingArea.innerText = words[count % words.length];
                    count++;
                }, 100);

                setTimeout(() => {
                    clearInterval(rollingTimer);
                    rollingTimer = null;
                    rollingArea.style.display = 'none';

                    const total = checkedState.length;
                    const checked = checkedState.filter(v => v).length;
                    const percent = total === 0 ? 0 : Math.round((checked / total) * 100);
                    const level = getHorseLevel(percent);

                    // æŒ‰ç­‰çº§éšæœºè¿åŠ¿
                    const levelFortunes = FORTUNES.filter(f => f.level === (percent < 20 ? 1 : percent < 40 ? 2 : percent < 60 ? 3 : percent < 80 ? 4 : 5));
                    const fortune = levelFortunes[Math.floor(Math.random() * levelFortunes.length)].text;

                    resultHorseName.textContent = level.name;
                    resultHorseDesc.textContent = level.desc;
                    resultFortune.textContent = fortune;

                    resultDisplay.style.display = 'block';
                }, 1500);
            }

            // ========== æˆªå›¾åŠŸèƒ½ ==========
            async function takeScreenshot() {
                showToast('ç”Ÿæˆä¸­...');
                try {
                    const canvas = await html2canvas(document.getElementById('app'), {
                        scale: 2,
                        backgroundColor: '#fff8f5',
                        logging: false,
                        allowTaint: false,
                        useCORS: true
                    });

                    const imgData = canvas.toDataURL('image/png');
                    const isMobile = /iPhone|iPad|iPod/i.test(navigator.userAgent);
                    const saveTip = isMobile ? 'ğŸ‘† é•¿æŒ‰å›¾ç‰‡ä¿å­˜åˆ°ç›¸å†Œ' : 'ğŸ–±ï¸ å³é”®å›¾ç‰‡å¦å­˜ä¸º';

                    const overlay = document.createElement('div');
                    overlay.className = 'image-modal-overlay';
                    overlay.innerHTML = `
                        <div class="image-modal-container">
                            <div class="image-modal-body">
                                <img src="${imgData}" alt="é©¬å¹´äººç”Ÿè¿›åº¦">
                            </div>
                            <div class="image-modal-footer">
                                <div class="save-tip">${saveTip}</div>
                                <div class="close-modal-btn">å…³ é—­</div>
                            </div>
                        </div>
                    `;

                    document.body.appendChild(overlay);
                    document.body.style.overflow = 'hidden';

                    const closeModal = () => {
                        overlay.remove();
                        document.body.style.overflow = '';
                    };

                    overlay.addEventListener('click', (e) => {
                        if (e.target === overlay) closeModal();
                    });
                    overlay.querySelector('.close-modal-btn').addEventListener('click', closeModal);

                } catch (error) {
                    showToast('æˆªå›¾å¤±è´¥: ' + error.message);
                    console.error(error);
                }
            }

            function showToast(msg) {
                toast.textContent = msg;
                toast.classList.add('show');
                setTimeout(() => toast.classList.remove('show'), 2000);
            }

            // ========== äº‹ä»¶ç»‘å®š ==========
            exportBtn.addEventListener('click', exportChecklist);
            importBtn.addEventListener('click', importChecklist);
            resetBtn.addEventListener('click', resetChecklist);
            addChapterBtn.addEventListener('click', () => {
                const newChapter = { icon: "ğŸ“¦", name: "æ–°å…³å¡", tasks: [] };
                chapters.push(newChapter);
                expandedState[chapters.length - 1] = false; // é»˜è®¤æŠ˜å 
                let newChecked = [];
                chapters.forEach(c => c.tasks.forEach(() => newChecked.push(false)));
                for (let i = 0; i < Math.min(checkedState.length, newChecked.length); i++) newChecked[i] = checkedState[i];
                checkedState = newChecked;
                renderChapters();
                updateProgress();
                saveToLocalStorage(); // ä¿å­˜
                showToast('æ–°å…³å¡å·²æ·»åŠ ');
            });

            revealBtn.addEventListener('click', startRolling);
            retestBtn.addEventListener('click', startRolling);
            shareBtn.addEventListener('click', () => {
                showToast('ç‚¹å‡»æˆªå›¾æŒ‰é’®ç”Ÿæˆå›¾ç‰‡ååˆ†äº«');
            });

            generateBtn.addEventListener('click', takeScreenshot);

            cancelDelete.addEventListener('click', () => {
                deleteModal.classList.remove('show');
                pendingDeleteChapter = null;
            });

            confirmDelete.addEventListener('click', () => {
                if (pendingDeleteChapter !== null) {
                    chapters.splice(pendingDeleteChapter, 1);
                    let newChecked = [];
                    chapters.forEach(c => c.tasks.forEach(() => newChecked.push(false)));
                    checkedState = newChecked;
                    expandedState = {};
                    chapters.forEach((_, idx) => { expandedState[idx] = false; }); // æŠ˜å 
                    renderChapters();
                    updateProgress();
                    deleteModal.classList.remove('show');
                    pendingDeleteChapter = null;
                    saveToLocalStorage(); // ä¿å­˜
                    showToast('å…³å¡å·²åˆ é™¤');
                }
            });

            deleteModal.addEventListener('click', (e) => {
                if (e.target === deleteModal) {
                    deleteModal.classList.remove('show');
                    pendingDeleteChapter = null;
                }
            });

            // åˆå§‹åŒ–
            initData();
            renderChapters();
            updateProgress();
            generateQRCode();
            setupStickyScroll();
        })();
    </script>
</body>
</html>